

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Installation &mdash; Sonata ~ MediaBundle  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Sonata ~ MediaBundle  documentation" href="../index.html"/>
        <link rel="next" title="2. Helpers" href="helpers.html"/>
        <link rel="prev" title="Media Bundle Documentation" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Sonata ~ MediaBundle</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">1. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#base-bundles">1.1. Base bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">1.2. Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="helpers.html">2. Helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="helpers.html#php-usage">2.1. PHP Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html#twig-usage">2.2. Twig usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="helpers.html#thumbnails-for-files">2.3. Thumbnails for files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="creating_a_provider_class.html">3. Creating a Media Provider: A Vimeo Provider</a><ul>
<li class="toctree-l2"><a class="reference internal" href="creating_a_provider_class.html#media-entity">3.1. Media Entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_a_provider_class.html#case-study">3.2. Case Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_a_provider_class.html#initialize-the-class">3.3. Initialize the class</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_a_provider_class.html#register-the-class-with-the-service-container">3.4. Register the Class with the Service Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating_a_provider_class.html#view-helper">3.5. View Helper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="media_context.html">4. Media Context</a><ul>
<li class="toctree-l2"><a class="reference internal" href="media_context.html#adminbundle-integration">4.1. <tt class="docutils literal"><span class="pre">AdminBundle</span></tt> Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">5. Usages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage.html#saving-a-media-file">5.1. Saving a media file</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage.html#retrieving-metadata-information">5.2. Retrieving metadata information</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="form.html">6. Form Type</a><ul>
<li class="toctree-l2"><a class="reference internal" href="form.html#media-type">6.1. Media Type</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="security.html">7. Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="security.html#configuration-example">7.1. Configuration Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html#creating-your-own-security-download-strategy">7.2. Creating your own Security Download Strategy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">8. Command Line Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="command_line.html#media-commands">8.1. Media commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_configuration.html">9. Advanced Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="amazon_s3.html">10. Amazon S3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="amazon_s3.html#configuration">10.1. Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extra.html">11. Extra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extra.html#pixlr-integration">11.1. Pixlr Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extra.html#sonata-notification-bundle-integration">12. Sonata Notification Bundle Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra.html#liip-imagine-bundle-integration">13. Liip Imagine Bundle Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="extra.html#ckeditor-integration">14. CKEditor Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extra.html#medias-in-ckeditor-with-cooptilleulsckeditorsonatamediabundle">14.1. Medias in CKEditor with CoopTilleulsCKEditorSonataMediaBundle</a></li>
<li class="toctree-l2"><a class="reference internal" href="extra.html#medias-in-ckeditor-with-sonataformatterbundle">14.2. Medias in CKEditor with SonataFormatterBundle</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">15. API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#setup">15.1. Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#serialization">15.2. Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#sending-a-media-file">15.3. Sending a media file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">16. Troubleshooting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html#media-formats">16.1. Media Formats</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Sonata ~ MediaBundle</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>1. Installation</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/reference/installation.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="installation">
<h1>1. Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="base-bundles">
<h2>1.1. Base bundles<a class="headerlink" href="#base-bundles" title="Permalink to this headline">¶</a></h2>
<p>This bundle is mainly dependant of:</p>
<ul class="simple">
<li>Classification: <a class="reference external" href="https://sonata-project.org/bundles/classification">https://sonata-project.org/bundles/classification</a></li>
<li>Core: <a class="reference external" href="https://sonata-project.org/bundles/core">https://sonata-project.org/bundles/core</a></li>
<li>Intl: <a class="reference external" href="https://sonata-project.org/bundles/intl">https://sonata-project.org/bundles/intl</a></li>
</ul>
<p>This bundle has optional dependancies of:</p>
<blockquote>
<div><ul class="simple">
<li>Admin: <a class="reference external" href="https://sonata-project.org/bundles/admin">https://sonata-project.org/bundles/admin</a></li>
<li>DoctrineOrm: <a class="reference external" href="https://sonata-project.org/bundles/doctrine-orm-admin">https://sonata-project.org/bundles/doctrine-orm-admin</a></li>
<li>MongoAdmin: <a class="reference external" href="https://sonata-project.org/bundles/mongo-admin">https://sonata-project.org/bundles/mongo-admin</a></li>
</ul>
</div></blockquote>
<p>So be sure you have installed those bundles before starting</p>
</div>
<div class="section" id="id1">
<h2>1.2. Installation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Retrieve the bundle with composer:</p>
<div class="highlight-sh"><div class="highlight"><pre>php composer.phar require sonata-project/media-bundle --no-update
</pre></div>
</div>
<p>Register these bundles in your AppKernel:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="c1">// app/AppKernel.php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">registerBundles</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
        <span class="c1">// ...</span>
        <span class="k">new</span> <span class="nx">Sonata\MediaBundle\SonataMediaBundle</span><span class="p">(),</span>
        <span class="k">new</span> <span class="nx">Sonata\EasyExtendsBundle\SonataEasyExtendsBundle</span><span class="p">(),</span>
        <span class="k">new</span> <span class="nx">Sonata\IntlBundle\SonataIntlBundle</span><span class="p">(),</span>

        <span class="c1">//You need to add this dependency to make media functional</span>
        <span class="k">new</span> <span class="nx">JMS\SerializerBundle\JMSSerializerBundle</span><span class="p">(),</span>
        <span class="c1">// ...</span>
    <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, add the correct routing files:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">gallery</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;@SonataMediaBundle/Resources/config/routing/gallery.xml&#39;</span>
    <span class="l-Scalar-Plain">prefix</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/media/gallery</span>

<span class="l-Scalar-Plain">media</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">resource</span><span class="p-Indicator">:</span> <span class="s">&#39;@SonataMediaBundle/Resources/config/routing/media.xml&#39;</span>
    <span class="l-Scalar-Plain">prefix</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/media</span>
</pre></div>
</div>
<p>Then you must configure the interaction with the orm and add the mediaBundles settings:</p>
<p>Doctrine ORM:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>

<span class="l-Scalar-Plain">doctrine</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">orm</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">entity_managers</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">default</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">mappings</span><span class="p-Indicator">:</span>
                    <span class="l-Scalar-Plain">SonataMediaBundle</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">~</span>

    <span class="l-Scalar-Plain">dbal</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">types</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">json</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Sonata\Doctrine\Types\JsonType</span>
</pre></div>
</div>
<p>Doctrine PHPCR:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>

<span class="l-Scalar-Plain">doctrine_phpcr</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">odm</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">auto_mapping</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
        <span class="l-Scalar-Plain">mappings</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">SonataMediaBundle</span><span class="p-Indicator">:</span>
                <span class="l-Scalar-Plain">prefix</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Sonata\MediaBundle\PHPCR</span>
</pre></div>
</div>
<div class="highlight-yaml"><div class="highlight"><pre># app/config/config.yml

sonata_media:
    # if you don&#39;t use default namespace configuration
    #class:
    #    media: MyVendor\MediaBundle\Entity\Media
    #    gallery: MyVendor\MediaBundle\Entity\Gallery
    #    gallery_has_media: MyVendor\MediaBundle\Entity\GalleryHasMedia
    default_context: default
    db_driver: doctrine_orm # or doctrine_mongodb, doctrine_phpcr it is mandatory to choose one here
    default_context: default # you need to set a context
    contexts:
        default:  # the default context is mandatory
            providers:
                - sonata.media.provider.dailymotion
                - sonata.media.provider.youtube
                - sonata.media.provider.image
                - sonata.media.provider.file

            formats:
                small: { width: 100 , quality: 70}
                big:   { width: 500 , quality: 70}

    cdn:
        server:
            path: /uploads/media # http://media.sonata-project.org/

    filesystem:
        local:
            directory:  %kernel.root_dir%/../web/uploads/media
            create:     false
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can define formats per provider type. You might want to set
a transversal <tt class="docutils literal"><span class="pre">admin</span></tt> format to be used by the <tt class="docutils literal"><span class="pre">mediaadmin</span></tt> class.</p>
</div>
<p>Also, you can determine the resizer to use; the default value is
<tt class="docutils literal"><span class="pre">sonata.media.resizer.simple</span></tt> but you can change it to <tt class="docutils literal"><span class="pre">sonata.media.resizer.square</span></tt></p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># app/config/config.yml</span>

<span class="l-Scalar-Plain">sonata_media</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">providers</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">image</span><span class="p-Indicator">:</span>
            <span class="l-Scalar-Plain">resizer</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">sonata.media.resizer.square</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The square resizer works like the simple resizer when the image format has
only the width. But if you specify the height the resizer crop the image in
the lower size.</p>
</div>
<p>At this point, the bundle is not yet ready. You need to generate the correct
entities for the media:</p>
<div class="highlight-python"><div class="highlight"><pre>php app/console sonata:easy-extends:generate --dest=src SonataMediaBundle
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To be able to generate domain objects, you need to have a database driver configure in your project.
If it&#8217;s not the case, just follow this:
<a class="reference external" href="http://symfony.com/doc/current/book/doctrine.html#configuring-the-database">http://symfony.com/doc/current/book/doctrine.html#configuring-the-database</a></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The command will generate domain objects in an <tt class="docutils literal"><span class="pre">Application</span></tt> namespace.
So you can point entities&#8217; associations to a global and common namespace.
This will make Entities sharing very easier as your models will allow to
point to a global namespace. For instance the media will be
<tt class="docutils literal"><span class="pre">Application\Sonata\MediaBundle\Entity\Media</span></tt>.</p>
</div>
<p>Now that your module is generated, you can register it</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="c1">// app/AppKernel.php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">registerBundles</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">array</span><span class="p">(</span>
        <span class="o">...</span>
        <span class="k">new</span> <span class="nx">Application\Sonata\MediaBundle\ApplicationSonataMediaBundle</span><span class="p">(),</span>
        <span class="o">...</span>
    <span class="p">);</span>
<span class="p">}</span>

<span class="c1"># app/config/config.yml</span>
  <span class="nx">doctrine</span><span class="o">:</span>
      <span class="nx">orm</span><span class="o">:</span>
          <span class="nx">entity_managers</span><span class="o">:</span>
              <span class="k">default</span><span class="o">:</span>
                  <span class="nx">mappings</span><span class="o">:</span>
                      <span class="nx">ApplicationSonataMediaBundle</span><span class="o">:</span> <span class="o">~</span>
                      <span class="nx">SonataMediaBundle</span><span class="o">:</span> <span class="o">~</span>
                      <span class="c1"># add your own bundles here</span>
</pre></div>
</div>
<p>Now, you can build up your database:</p>
<div class="highlight-sh"><div class="highlight"><pre>app/console doctrine:schema:<span class="o">[</span>create|update<span class="o">]</span>
</pre></div>
</div>
<p>If they are not already created, you need to add specific folder to allow uploads from users:</p>
<div class="highlight-sh"><div class="highlight"><pre>mkdir web/uploads
mkdir web/uploads/media
chmod -R 0777 web/uploads
</pre></div>
</div>
<p>Then you can visit your admin dashboard on <a class="reference external" href="http://my-server/admin/dashboard">http://my-server/admin/dashboard</a></p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="helpers.html" class="btn btn-neutral float-right" title="2. Helpers"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="Media Bundle Documentation"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2014, Thomas Rabaix.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>